# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
lang en_US.UTF-8
keyboard us
network --onboot yes --device eth0 --bootproto dhcp --noipv6
network --onboot yes --device eth1 --bootproto dhcp --noipv6
rootpw  --iscrypted $6$6fS4zbNOI2UURMtJ$Mln.yZoXDaQKqKxY80YCR7cR4ig0L59B/.oNqWoi.2uVeUqCUO4WV8YiOrMwrXAFghap/bDQEpWAN47UiTttE/
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512
selinux --enforcing
timezone --utc America/Los_Angeles
bootloader --location=mbr --driveorder=sda --append="crashkernel=auto rhgb quiet"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
#clearpart --all --drives=sda
#volgroup VolGroup --pesize=4096 pv.008002
#logvol / --fstype=ext4 --name=lv_root --vgname=VolGroup --grow --size=1024 --maxsize=51200
#logvol swap --name=lv_swap --vgname=VolGroup --grow --size=2048 --maxsize=2048

#part /boot --fstype=ext4 --size=500
#part pv.008002 --grow --size=1



repo --name="CentOS"  --baseurl=cdrom:sr0 --cost=100

%packages --nobase
@core
wget
gcc
kernel-devel
perl
%end

%post --nochroot
# Create the Chef user and password for the test infrastructure
useradd chef
echo "chef:testchef" | chpasswd
# Add chef to the sudoers file
echo "chef ALL=(ALL)	ALL" >> /etc/sudoers
# Create the Docker group and add 'chef' to it
groupadd docker
usermod -a -G docker chef
# Modify /etc/sysconfig/iptables (Flush)
echo "*filter\n:INPUT ACCEPT [0:0]\n:FORWARD ACCEPT [0:0]\n:OUTPUT ACCEPT [0:0]\nCOMMIT" > /etc/sysconfig/iptables
# Update packages
yum -y update
# Install dkms
wget http://linux.del.com/dkms/dkms-2.2.0.3-1.noarch.rpm
rpm -Uvh dkms-2.2.0.3-1.noarch.rpm
# Mount the Guest Additions disk
mount /dev/cdrom /mnt
# Install Guest Additions
cd /mnt
./VBoxLinuxAdditions.sh
usermod -a -G vboxsf chef
# Remove the file /etc/udev/rules.d/70-persistent-net.rules
rm /etc/udev/rules.d/70-persistent-net.rules
# Remove the MAC address from ifcfg-ethX files
sed 's/HWADDR=.*//' /etc/sysconfig/network-scripts/ifcfg-eth0
sed 's/HWADDR=.*//' /etc/sysconfig/network-scripts/ifcfg-eth1
%end





